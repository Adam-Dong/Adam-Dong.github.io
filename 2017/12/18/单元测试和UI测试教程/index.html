<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="Adam-Dong"><title>iOS单元测试和UI测试教程 · 宁 静 以 致 远</title><meta name="description" content="iOS Unit Testing and UI Testing Tutorial -raywenderlich
iOS 单元测试和UI测试教程 - cocoachina翻译版
Demo :  iOS Unit Testing and UI Testing Tutorial


什么是测试？在编写测试"><meta name="keywords"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;"><h3 title=""><a href="/">宁 静 以 致 远</a></h3></div></div><ul class="social-links"></ul><div class="footer"><a target="_blank" href="/"><span>Theme by </span></a><a href="https://www.caicai.me"> CaiCai </a><span>&</span><a href="https://github.com/Ben02/hexo-theme-Anatole"> Ben</a><div class="by_farbox"><a href="https://hexo.io/zh-cn/" target="_blank">Proudly published with Hexo&#65281;</a></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/about">关于</a></li><li><a href="/archives">归档</a></li><li><a href="/links">友链</a></li></div><div class="information"><div class="back_btn"><li><a onclick="window.history.go(-1)" class="fa fa-chevron-left"> </a></li></div><div class="avatar"><img></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>iOS单元测试和UI测试教程</a></h3></div><div class="post-content"><ul>
<li><a href="https://www.raywenderlich.com/150073/ios-unit-testing-and-ui-testing-tutorial" target="_blank" rel="noopener">iOS Unit Testing and UI Testing Tutorial</a> -raywenderlich</li>
<li><a href="http://www.cocoachina.com/ios/20170718/19930.html" target="_blank" rel="noopener">iOS 单元测试和UI测试教程</a> - cocoachina翻译版</li>
<li>Demo :  <a href="https://github.com/Adam-Dong/iOS-Unit-Testing-and-UI-Testing-Tutorial" target="_blank" rel="noopener">iOS Unit Testing and UI Testing Tutorial</a></li>
</ul>
<hr>
<h3 id="什么是测试？"><a href="#什么是测试？" class="headerlink" title="什么是测试？"></a>什么是测试？</h3><p>在编写测试之前，首先需要知道：你应该测试什么？如果你的目标是修改一个已有的 App，你首先应该对准备修改的组件编写测试。<br>通常，测试应当包含：</p>
<ul>
<li>核心功能：模型类和方法，以及它们和控制器的交互</li>
<li>最常用的 UI 操作</li>
<li>边际条件</li>
<li>bug 修复</li>
</ul>
<hr>
<h3 id="FIRST-原则：测试的最佳实践"><a href="#FIRST-原则：测试的最佳实践" class="headerlink" title="FIRST 原则：测试的最佳实践"></a>FIRST 原则：测试的最佳实践</h3><p>FIRST 是几个单词的缩写，简要描述了有效的单元测试需要什么条件，这些条件包括：</p>
<ol>
<li>Fast：测试的<strong>运行速度要快</strong>，这样人们就不介意你运行它们了。</li>
<li>Independent/Isolated：一个<strong>测试不应当依赖</strong>于另一个测试。</li>
<li>Repeatable：同一个测试，<strong>每次</strong>都应当<strong>获得相同的结果</strong>。外部数据提供者和并发问题会导致间歇性的出错。</li>
<li>Self-validating：测试应当是<strong>完全自动化</strong>的，输出结果要么是 pass 要么是 fail，而不是依靠程序员对日志文件的解释。</li>
<li>Timely：理想情况下，测试的编写，应当在编写要测试的产品代码之前。(<strong>先于产品代码</strong>)</li>
</ol>
<p>遵循 FIRST 原则会让你的测试清晰和有用，而不会成为 App 的渊薮。</p>
<hr>
<h3 id="单元测试基本操作"><a href="#单元测试基本操作" class="headerlink" title="单元测试基本操作"></a>单元测试基本操作</h3><ul>
<li>创建Unit Test Target</li>
<li><p>编写测试代码 （SUT：被测系统 System Under Test）</p>
<ol>
<li>在 setup() 中创建 SUT，在 tearDown() 中释放 SUT</li>
<li>测试方法的名字总是以 test 开头，后面加上一个对测试内容的描述。</li>
<li>将测试方法分成 given、when 和 then 三个部分是一种好的做法：</li>
</ol>
</li>
<li><p>点击运行测试方法</p>
</li>
</ul>
<hr>
<h3 id="Using-XCTAssert-to-Test-Models"><a href="#Using-XCTAssert-to-Test-Models" class="headerlink" title="Using XCTAssert to Test Models"></a>Using XCTAssert to Test Models</h3><p>见 <a href="https://github.com/Adam-Dong/iOS-Unit-Testing-and-UI-Testing-Tutorial/blob/master/BullsEye/BullsEyeTests/BullsEyeTests.swift）" target="_blank" rel="noopener">BullsEyeTests.Swift</a><br>    <figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>. <span class="keyword">import</span></span><br><span class="line"><span class="meta">@testable</span> <span class="keyword">import</span> BullsEye</span><br><span class="line"><span class="number">2</span>. setUp and tearDown</span><br><span class="line">setUp() &#123;</span><br><span class="line">    gameUnderTest = <span class="type">BullsEyeGame</span>()</span><br><span class="line">&#125;</span><br><span class="line">tearDown() &#123;</span><br><span class="line">    gameUnderTest = <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="number">3</span>. given/when/then</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">testScoreIsComputed</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// 1. given</span></span><br><span class="line">    <span class="keyword">let</span> guess = gameUnderTest.targetValue + <span class="number">5</span></span><br><span class="line">    <span class="comment">// 2. when</span></span><br><span class="line">    <span class="number">_</span> = gameUnderTest.check(guess: guess)</span><br><span class="line">    <span class="comment">// 3. then</span></span><br><span class="line">    <span class="type">XCTAssertEqual</span>(gameUnderTest.scoreRound, <span class="number">95</span>, <span class="string">"Score computed from guess is wrong"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<h3 id="在测试中进行-debug"><a href="#在测试中进行-debug" class="headerlink" title="在测试中进行 debug"></a>在测试中进行 debug</h3><p>在断点导航器中，添加一个 Test Failure 断点，这样，当测试方法断言失败时，测试会停止</p>
<hr>
<h3 id="用-XCTestExpectation-测试异步操作"><a href="#用-XCTestExpectation-测试异步操作" class="headerlink" title="用 XCTestExpectation 测试异步操作"></a>用 XCTestExpectation 测试异步操作</h3></div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2017-12-18</span><i class="fa fa-tag"></i><a href="/tags/iOS/" title="iOS" class="tag">iOS </a><a href="/tags/单元测试/" title="单元测试" class="tag">单元测试 </a><a href="/tags/UI测试/" title="UI测试" class="tag">UI测试 </a><a href="/tags/iOS-Unit-Testing/" title="iOS Unit Testing" class="tag">iOS Unit Testing </a><a href="/tags/iOS-UI-Testing/" title="iOS UI Testing" class="tag">iOS UI Testing </a></div></div></div></div><div class="share"><div class="evernote"><a href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank" class="fa fa-bookmark"></a></div><div class="weibo"><a href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));" class="fa fa-weibo"></a></div><div class="twitter"><a href="http://twitter.com/home?status=,https://adam.github.io/2017/12/18/单元测试和UI测试教程/,宁 静 以 致 远,iOS单元测试和UI测试教程,;" class="fa fa-twitter"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a role="navigation" href="/2017/12/19/Swift数据结构与算法基础/" title="Swift数据结构与算法基础" class="btn">上一篇</a></li><li class="next pagbuttons"><a role="navigation" href="/2017/12/11/Test/" title="使用 hexo 免费搭建个人博客" class="btn">下一篇</a></li></ul></div></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>